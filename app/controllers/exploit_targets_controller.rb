class ExploitTargetsController < ComponentsController

  def index
    @components = ExploitTarget.all.group_by {|et|
      v = et.vulnerability.present?; w = et.weakness.present?; c = et.configuration.present?

      if v && !w && !c
        'Vulnerability'
      elsif w && !v && !c
        'Weakness'
      elsif c && !w && !v
        'Misconfiguration'
      else
        'Multiple'
      end
    }
    @components['Unknown Type'] = @components.delete(nil) if @components[nil]
  end

  def klass
    ExploitTarget
  end
end
